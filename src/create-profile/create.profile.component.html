<div class="content-w">
  <app-user-me *ngIf="userResponse" (userCreated)="doUserCreated($event)" [userResponse]="userResponse" [stepper]="true"></app-user-me>
  <mat-horizontal-stepper *ngIf="!userResponse" id="mat-stepper" [linear]="true" #stepper>
    <mat-step [completed]="organizationCompleted">
      <ng-template matStepLabel> ORGANIZATION</ng-template>

      <div class="os-tabs-w mx-4 controls">
        <div class="os-tabs-controls">
          <ul class="nav nav-tabs upper">
            <li class="nav-item">
              <a aria-expanded="false" *ngIf="!createdOrganization" class="nav-link" data-toggle="tab" (click)="toggleTab(0)">Join</a>
              <a aria-expanded="false" *ngIf="createdOrganization" class="nav-link disabled" data-toggle="tab">Join</a>
            </li>
            <li class="nav-item">
              <a aria-expanded="false" *ngIf="!requestAccessed" class="nav-link" data-toggle="tab" (click)="toggleTab(1)">Create</a>
              <a aria-expanded="false" *ngIf="requestAccessed" class="nav-link disabled" data-toggle="tab"> Create</a>
            </li>
          </ul>
        </div>
      </div>

      <div *ngIf="tab === 0" class="content-i"  id="request-access-form">
        <div class="content-box">
          <div class="element-wrapper">
            <div class="element-box">
              <form [formGroup]="requestAccessForm">
                <h5 class="form-header">
                  Request Access Form
                </h5>

                <div class="alert alert-info add-margin" role="alert">
                  <strong>Use the 'CREATE' tab above to make an organization.</strong>
                </div>

                <fieldset class="form-group">
                  <div class="form-group" [class]="(selectedOrganization.name === organizationId.value) ? 'ng2-completer-valid':'ng2-completer-invalid'">
                    <label for="organization"> Join An Organization</label>
                    <ng2-completer id="organization"
                                   [datasource]="organizationDataService"
                                   [minSearchLength]="0"
                                   [maxChars]="4"
                                   [inputClass]="'form-control'"
                                   [placeholder]="'Select An Organization'"
                                   [matchClass]="'match'"
                                   formControlName="organizationId"
                                   [autofocus]="true"
                                   [clearUnselected]="true"
                                   [fillHighlighted]="false"
                                   [openOnClick]="true"
                                   [textSearching]="false"
                                   (selected)="onOrganizationSelect($event)"
                                   required>
                    </ng2-completer>
                    <div [hidden]="selectedOrganization.name === organizationId.value || organizationId.pristine" class="alert alert-danger">Select an Organization.</div>
                  </div>
                </fieldset>
                <div [hidden]="doNotDisplayFailureMessage" class="alert alert-danger">Failed to Send Request. Please try again</div>

                <div class="form-buttons-w">
                  <button class="btn btn-primary button-margin" [disabled]="selectedOrganization.name !== organizationId.value" type="submit" (click)="onNext()"> Next</button>
                  <button class="btn btn-outline-danger" type="submit" (click)="onCancel()"> Cancel Request</button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>

      <app-organization-company *ngIf="tab === 1" (organizationCreated)="doOrganizationCreated();nextStep($event, 1)" [stepper]="true"></app-organization-company>

    </mat-step>
    <mat-step [completed]="userCompleted">
      <ng-template matStepLabel> PERSONAL</ng-template>
      <app-user-me (userCreated)="doUserCreated($event)" [stepper]="true"></app-user-me>
    </mat-step>
  </mat-horizontal-stepper>
</div>
